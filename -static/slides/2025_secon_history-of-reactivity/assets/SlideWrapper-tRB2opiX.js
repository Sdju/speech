import{r as P,A as y,C as x,ah as Et,O as $e,ai as Pt,y as Ct,Y as K,p as kt,P as G,d as O,f as T,i as se,o as k,aj as $t,L as Mt,K as nt,ak as Q,k as j,g as M,j as Le,F as ne,a9 as Tt,al as rt,ae as it,a8 as Lt,ad as te,b as ot,am as At,a1 as Rt,_ as Xe,t as R,e as Y,an as Dt,D as pe,w as It,n as me,M as at,S as zt,ao as Ft,ap as Nt,a4 as Ut,h as Fe,H as Ot,B as Xt}from"./modules/vue-B5pjl96G.js";import{Y as lt,l as de,h as Ae,Z as Me,$ as Ye,a0 as Yt,a1 as Bt,a2 as re,a3 as jt,a4 as Kt,a5 as Be,a6 as je,a7 as Ke,a8 as Ge,v as Gt,a as Vt,a9 as qt,_ as ct,f as Ht,d as Zt,g as Qt,e as Wt,i as Jt,b as es,aa as ts}from"./index-BztLmv4E.js";import{u as V}from"./slidev/context-B1edYdcO.js";import{x as ss}from"./modules/unplugin-icons-yzowHtqB.js";import{t as ns}from"./bundle-mjs-DPDMyaZw.js";function rs(e){var t;return{info:P(((t=lt(e))==null?void 0:t.meta.slide)??null),update:async()=>{}}}const Te={};function $n(e){function t(n){return Te[n]??(Te[n]=rs(n))}return{info:y({get(){return t(x(e)).info.value},set(n){t(x(e)).info.value=n}}),update:async(n,r)=>{const s=t(r??x(e)),i=await s.update(n);return i&&(s.info.value=i),i}}}var is=Object.defineProperty,Ve=Object.getOwnPropertySymbols,os=Object.prototype.hasOwnProperty,as=Object.prototype.propertyIsEnumerable,qe=(e,t,n)=>t in e?is(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Re=(e,t)=>{for(var n in t||(t={}))os.call(t,n)&&qe(e,n,t[n]);if(Ve)for(var n of Ve(t))as.call(t,n)&&qe(e,n,t[n]);return e},ls=()=>({emit(e,...t){for(let n=this.events[e]||[],r=0,s=n.length;r<s;r++)n[r](...t)},events:{},on(e,t){var n;return((n=this.events)[e]||(n[e]=[])).push(t),()=>{var r;this.events[e]=(r=this.events[e])==null?void 0:r.filter(s=>t!==s)}}});function ge(e,t){return e-t}function cs(e){return e<0?-1:1}function ye(e){return[Math.abs(e),cs(e)]}function ut(){const e=()=>((1+Math.random())*65536|0).toString(16).substring(1);return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}var us=2,B=us;function dt(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg","defs"),r=document.createElementNS("http://www.w3.org/2000/svg","marker"),s=document.createElementNS("http://www.w3.org/2000/svg","path");return s.setAttribute("fill",t),r.setAttribute("id",e),r.setAttribute("viewBox","0 -5 10 10"),r.setAttribute("refX","5"),r.setAttribute("refY","0"),r.setAttribute("markerWidth","4"),r.setAttribute("markerHeight","4"),r.setAttribute("orient","auto"),s.setAttribute("d","M0,-5L10,0L0,5"),r.appendChild(s),n.appendChild(r),n}function ds(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function hs(e,t,n){let r=t.x,s=t.y,i=n.x-r,a=n.y-s;if(i!==0||a!==0){const o=((e.x-r)*i+(e.y-s)*a)/(i*i+a*a);o>1?(r=n.x,s=n.y):o>0&&(r+=i*o,s+=a*o)}return i=e.x-r,a=e.y-s,i*i+a*a}function fs(e,t){let n=e[0];const r=[n];let s;for(let i=1,a=e.length;i<a;i++)s=e[i],ds(s,n)>t&&(r.push(s),n=s);return n!==s&&s&&r.push(s),r}function De(e,t,n,r,s){let i=r,a=0;for(let o=t+1;o<n;o++){const l=hs(e[o],e[t],e[n]);l>i&&(a=o,i=l)}i>r&&(a-t>1&&De(e,t,a,r,s),s.push(e[a]),n-a>1&&De(e,a,n,r,s))}function vs(e,t){const n=e.length-1,r=[e[0]];return De(e,0,n,t,r),r.push(e[n]),r}function He(e,t,n=!1){if(e.length<=2)return e;const r=t*t;return e=n?e:fs(e,r),e=vs(e,r),e}var ie=class{constructor(e){this.drauu=e,this.event=void 0,this.point=void 0,this.start=void 0,this.el=null}onSelected(e){}onUnselected(){}onStart(e){}onMove(e){return!1}onEnd(e){}get brush(){return this.drauu.brush}get shiftPressed(){return this.drauu.shiftPressed}get altPressed(){return this.drauu.altPressed}get svgElement(){return this.drauu.el}getMousePosition(e){var t,n,r,s;const i=this.drauu.el,a=(t=this.drauu.options.cssZoom)!=null?t:1,o=(n=this.drauu.options.coordinateScale)!=null?n:1,l=(r=this.drauu.options.offset)!=null?r:{x:0,y:0};if(this.drauu.options.coordinateTransform===!1){const h=this.drauu.el.getBoundingClientRect();return{x:(e.pageX/a-h.left+l.x)*o,y:(e.pageY/a-h.top+l.y)*o,pressure:e.pressure}}else{const h=this.drauu.svgPoint;h.x=e.clientX/a+l.x,h.y=e.clientY/a+l.y;const c=h.matrixTransform((s=i.getScreenCTM())==null?void 0:s.inverse());return{x:c.x*o,y:c.y*o,pressure:e.pressure}}}createElement(e,t){var n;const r=document.createElementNS("http://www.w3.org/2000/svg",e),s=t?Re(Re({},this.brush),t):this.brush;return r.setAttribute("fill",(n=s.fill)!=null?n:"transparent"),r.setAttribute("stroke",s.color),r.setAttribute("stroke-width",s.size.toString()),r.setAttribute("stroke-linecap","round"),s.dasharray&&r.setAttribute("stroke-dasharray",s.dasharray),r}attr(e,t){this.el.setAttribute(e,typeof t=="string"?t:t.toFixed(B))}_setEvent(e){this.event=e,this.point=this.getMousePosition(e)}_eventDown(e){return this._setEvent(e),this.start=this.point,this.onStart(this.point)}_eventMove(e){return this._setEvent(e),this.onMove(this.point)}_eventUp(e){return this._setEvent(e),this.onEnd(this.point)}},ps=class J extends ie{constructor(){super(...arguments),this.points=[],this.count=0}onStart(t){if(this.el=this.createElement("path",{fill:"transparent"}),this.points=[t],this.brush.arrowEnd){this.arrowId=ut();const n=dt(this.arrowId,this.brush.color);this.el.appendChild(n)}return this.el}onMove(t){return this.el||this.onStart(t),this.points[this.points.length-1]!==t&&(this.points.push(t),this.count+=1),this.count>5&&(this.points=He(this.points,1,!0),this.count=0),this.attr("d",J.toSvgData(this.points)),!0}onEnd(){const t=this.el;if(this.el=null,!t)return!1;if(t.setAttribute("d",J.toSvgData(He(this.points,1,!0))),!t.getTotalLength()){const{x:n,y:r}=this.points[0],s=this.brush.size/2;t.setAttribute("d",`M ${n-s} ${r} a ${s},${s} 0 1,0 ${s*2},0 a ${s},${s} 0 1,0 ${-s*2},0`),t.setAttribute("fill",this.brush.color),t.setAttribute("stroke-width","0")}return!0}static line(t,n){const r=n.x-t.x,s=n.y-t.y;return{length:Math.sqrt(r**2+s**2),angle:Math.atan2(s,r)}}static controlPoint(t,n,r,s){const i=n||t,a=r||t,o=.2,l=J.line(i,a),h=l.angle+(s?Math.PI:0),c=l.length*o,p=t.x+Math.cos(h)*c,E=t.y+Math.sin(h)*c;return{x:p,y:E}}static bezierCommand(t,n,r){const s=J.controlPoint(r[n-1],r[n-2],t),i=J.controlPoint(t,r[n-1],r[n+1],!0);return`C ${s.x.toFixed(B)},${s.y.toFixed(B)} ${i.x.toFixed(B)},${i.y.toFixed(B)} ${t.x.toFixed(B)},${t.y.toFixed(B)}`}static toSvgData(t){return t.reduce((n,r,s,i)=>s===0?`M ${r.x.toFixed(B)},${r.y.toFixed(B)}`:`${n} ${J.bezierCommand(r,s,i)}`,"")}},ms=class extends ie{onStart(e){return this.el=this.createElement("ellipse"),this.attr("cx",e.x),this.attr("cy",e.y),this.el}onMove(e){if(!this.el||!this.start)return!1;let[t,n]=ye(e.x-this.start.x),[r,s]=ye(e.y-this.start.y);if(this.shiftPressed){const i=Math.min(t,r);t=i,r=i}if(this.altPressed)this.attr("cx",this.start.x),this.attr("cy",this.start.y),this.attr("rx",t),this.attr("ry",r);else{const[i,a]=[this.start.x,this.start.x+t*n].sort(ge),[o,l]=[this.start.y,this.start.y+r*s].sort(ge);this.attr("cx",(i+a)/2),this.attr("cy",(o+l)/2),this.attr("rx",(a-i)/2),this.attr("ry",(l-o)/2)}return!0}onEnd(){const e=this.el;if(this.el=null,!e)return!1;try{if(!e.getTotalLength())return!1}catch{return!1}return!0}},gs=class extends ie{constructor(){super(...arguments),this.pathSubFactor=20,this.pathFragments=[],this._erased=[]}onSelected(e){const t=(n,r)=>{if(n&&n.length)for(let s=0;s<n.length;s++){const i=n[s];if(i.getTotalLength){const a=i.getTotalLength();for(let o=0;o<this.pathSubFactor;o++){const l=i.getPointAtLength(a*o/this.pathSubFactor),h=i.getPointAtLength(a*(o+1)/this.pathSubFactor);this.pathFragments.push({x1:l.x,x2:h.x,y1:l.y,y2:h.y,segment:o,element:r||i})}}else i.children&&t(i.children,i)}};e&&t(e.children)}onUnselected(){this.pathFragments=[]}onStart(e){this.svgPointPrevious=this.svgElement.createSVGPoint(),this.svgPointPrevious.x=e.x,this.svgPointPrevious.y=e.y}onMove(e){this.svgPointCurrent=this.svgElement.createSVGPoint(),this.svgPointCurrent.x=e.x,this.svgPointCurrent.y=e.y;const t=this.checkAndEraseElement();return this.svgPointPrevious=this.svgPointCurrent,t}onEnd(){this.svgPointPrevious=void 0,this.svgPointCurrent=void 0;const e=this._erased;return this._erased=[],{undo:()=>e.forEach(t=>this.drauu._restoreNode(t)),redo:()=>e.forEach(t=>this.drauu._removeNode(t))}}checkAndEraseElement(){if(this.pathFragments.length)for(let e=0;e<this.pathFragments.length;e++){const t=this.pathFragments[e];if(this.svgPointPrevious&&this.svgPointCurrent){const n={x1:this.svgPointPrevious.x,x2:this.svgPointCurrent.x,y1:this.svgPointPrevious.y,y2:this.svgPointCurrent.y};this.lineLineIntersect(t,n)&&(this.drauu._removeNode(t.element),this._erased.push(t.element))}}return this._erased.length&&(this.pathFragments=this.pathFragments.filter(e=>!this._erased.includes(e.element))),this._erased.length>0}lineLineIntersect(e,t){const n=e.x1,r=e.x2,s=t.x1,i=t.x2,a=e.y1,o=e.y2,l=t.y1,h=t.y2,c=(n-r)*(l-h)-(a-o)*(s-i),p=(n*o-a*r)*(s-i)-(n-r)*(s*h-l*i),E=(n*o-a*r)*(l-h)-(a-o)*(s*h-l*i),f=(d,g,_)=>d>=g&&d<=_?!0:d>=_&&d<=g;if(c===0)return!1;{const d={x:p/c,y:E/c};return f(d.x,n,r)&&f(d.y,a,o)&&f(d.x,s,i)&&f(d.y,l,h)}}},ys=class extends ie{onStart(e){if(this.el=this.createElement("line",{fill:"transparent"}),this.attr("x1",e.x),this.attr("y1",e.y),this.attr("x2",e.x),this.attr("y2",e.y),this.brush.arrowEnd){const t=ut(),n=document.createElementNS("http://www.w3.org/2000/svg","g");return n.append(dt(t,this.brush.color)),n.append(this.el),this.attr("marker-end",`url(#${t})`),n}return this.el}onMove(e){if(!this.el)return!1;let{x:t,y:n}=e;if(this.shiftPressed){const r=e.x-this.start.x,s=e.y-this.start.y;if(s!==0){let i=r/s;i=Math.round(i),Math.abs(i)<=1?(t=this.start.x+s*i,n=this.start.y+s):(t=this.start.x+r,n=this.start.y)}}return this.altPressed?(this.attr("x1",this.start.x*2-t),this.attr("y1",this.start.y*2-n),this.attr("x2",t),this.attr("y2",n)):(this.attr("x1",this.start.x),this.attr("y1",this.start.y),this.attr("x2",t),this.attr("y2",n)),!0}onEnd(){const e=this.el;if(this.el=null,!e)return!1;try{if(e.getTotalLength()<5)return!1}catch{return!1}return!0}},_s=class extends ie{onStart(e){return this.el=this.createElement("rect"),this.brush.cornerRadius&&(this.attr("rx",this.brush.cornerRadius),this.attr("ry",this.brush.cornerRadius)),this.attr("x",e.x),this.attr("y",e.y),this.el}onMove(e){if(!this.el||!this.start)return!1;let[t,n]=ye(e.x-this.start.x),[r,s]=ye(e.y-this.start.y);if(this.shiftPressed){const i=Math.min(t,r);t=i,r=i}if(this.altPressed)this.attr("x",this.start.x-t),this.attr("y",this.start.y-r),this.attr("width",t*2),this.attr("height",r*2);else{const[i,a]=[this.start.x,this.start.x+t*n].sort(ge),[o,l]=[this.start.y,this.start.y+r*s].sort(ge);this.attr("x",i),this.attr("y",o),this.attr("width",a-i),this.attr("height",l-o)}return!0}onEnd(){const e=this.el;if(this.el=null,!e)return!1;try{if(!e.getTotalLength())return!1}catch{return!1}return!0}};function Ze(e,t,n,r=s=>s){return e*r(.5-t*(.5-n))}function xs(e){return[-e[0],-e[1]]}function U(e,t){return[e[0]+t[0],e[1]+t[1]]}function I(e,t){return[e[0]-t[0],e[1]-t[1]]}function N(e,t){return[e[0]*t,e[1]*t]}function ws(e,t){return[e[0]/t,e[1]/t]}function le(e){return[e[1],-e[0]]}function Qe(e,t){return e[0]*t[0]+e[1]*t[1]}function Ss(e,t){return e[0]===t[0]&&e[1]===t[1]}function bs(e){return Math.hypot(e[0],e[1])}function Es(e){return e[0]*e[0]+e[1]*e[1]}function We(e,t){return Es(I(e,t))}function ht(e){return ws(e,bs(e))}function Ps(e,t){return Math.hypot(e[1]-t[1],e[0]-t[0])}function ce(e,t,n){let r=Math.sin(n),s=Math.cos(n),i=e[0]-t[0],a=e[1]-t[1],o=i*s-a*r,l=i*r+a*s;return[o+t[0],l+t[1]]}function Ie(e,t,n){return U(e,N(I(t,e),n))}function Je(e,t,n){return U(e,N(t,n))}var{min:ee,PI:Cs}=Math,et=.275,ue=Cs+1e-4;function ks(e,t={}){let{size:n=16,smoothing:r=.5,thinning:s=.5,simulatePressure:i=!0,easing:a=b=>b,start:o={},end:l={},last:h=!1}=t,{cap:c=!0,easing:p=b=>b*(2-b)}=o,{cap:E=!0,easing:f=b=>--b*b*b+1}=l;if(e.length===0||n<=0)return[];let d=e[e.length-1].runningLength,g=o.taper===!1?0:o.taper===!0?Math.max(n,d):o.taper,_=l.taper===!1?0:l.taper===!0?Math.max(n,d):l.taper,w=Math.pow(n*r,2),m=[],u=[],v=e.slice(0,10).reduce((b,A)=>{let C=A.pressure;if(i){let $=ee(1,A.distance/n),Pe=ee(1,1-$);C=ee(1,b+(Pe-b)*($*et))}return(b+C)/2},e[0].pressure),S=Ze(n,s,e[e.length-1].pressure,a),L,oe=e[0].vector,z=e[0].point,F=z,D=z,X=F,be=!1;for(let b=0;b<e.length;b++){let{pressure:A}=e[b],{point:C,vector:$,distance:Pe,runningLength:ae}=e[b];if(b<e.length-1&&d-ae<3)continue;if(s){if(i){let Z=ee(1,Pe/n),ke=ee(1,1-Z);A=ee(1,v+(ke-v)*(Z*et))}S=Ze(n,s,A,a)}else S=n/2;L===void 0&&(L=S);let wt=ae<g?p(ae/g):1,St=d-ae<_?f((d-ae)/_):1;S=Math.max(.01,S*Math.min(wt,St));let Ne=(b<e.length-1?e[b+1]:e[b]).vector,Ce=b<e.length-1?Qe($,Ne):1,bt=Qe($,oe)<0&&!be,Ue=Ce!==null&&Ce<0;if(bt||Ue){let Z=N(le(oe),S);for(let ke=1/13,ve=0;ve<=1;ve+=ke)D=ce(I(C,Z),C,ue*ve),m.push(D),X=ce(U(C,Z),C,ue*-ve),u.push(X);z=D,F=X,Ue&&(be=!0);continue}if(be=!1,b===e.length-1){let Z=N(le($),S);m.push(I(C,Z)),u.push(U(C,Z));continue}let Oe=N(le(Ie(Ne,$,Ce)),S);D=I(C,Oe),(b<=1||We(z,D)>w)&&(m.push(D),z=D),X=U(C,Oe),(b<=1||We(F,X)>w)&&(u.push(X),F=X),v=A,oe=$}let q=e[0].point.slice(0,2),H=e.length>1?e[e.length-1].point.slice(0,2):U(e[0].point,[1,1]),Ee=[],fe=[];if(e.length===1){if(!(g||_)||h){let b=Je(q,ht(le(I(q,H))),-(L||S)),A=[];for(let C=1/13,$=C;$<=1;$+=C)A.push(ce(b,q,ue*2*$));return A}}else{if(!(g||_&&e.length===1))if(c)for(let A=1/13,C=A;C<=1;C+=A){let $=ce(u[0],q,ue*C);Ee.push($)}else{let A=I(m[0],u[0]),C=N(A,.5),$=N(A,.51);Ee.push(I(q,C),I(q,$),U(q,$),U(q,C))}let b=le(xs(e[e.length-1].vector));if(_||g&&e.length===1)fe.push(H);else if(E){let A=Je(H,b,S);for(let C=1/29,$=C;$<1;$+=C)fe.push(ce(A,H,ue*3*$))}else fe.push(U(H,N(b,S)),U(H,N(b,S*.99)),I(H,N(b,S*.99)),I(H,N(b,S)))}return m.concat(fe,u.reverse(),Ee)}function $s(e,t={}){var n;let{streamline:r=.5,size:s=16,last:i=!1}=t;if(e.length===0)return[];let a=.15+(1-r)*.85,o=Array.isArray(e[0])?e:e.map(({x:f,y:d,pressure:g=.5})=>[f,d,g]);if(o.length===2){let f=o[1];o=o.slice(0,-1);for(let d=1;d<5;d++)o.push(Ie(o[0],f,d/4))}o.length===1&&(o=[...o,[...U(o[0],[1,1]),...o[0].slice(2)]]);let l=[{point:[o[0][0],o[0][1]],pressure:o[0][2]>=0?o[0][2]:.25,vector:[1,1],distance:0,runningLength:0}],h=!1,c=0,p=l[0],E=o.length-1;for(let f=1;f<o.length;f++){let d=i&&f===E?o[f].slice(0,2):Ie(p.point,o[f],a);if(Ss(p.point,d))continue;let g=Ps(d,p.point);if(c+=g,f<E&&!h){if(c<s)continue;h=!0}p={point:d,pressure:o[f][2]>=0?o[f][2]:.5,vector:ht(I(p.point,d)),distance:g,runningLength:c},l.push(p)}return l[0].vector=((n=l[1])==null?void 0:n.vector)||[0,0],l}function Ms(e,t={}){return ks($s(e,t),t)}var Ts=class ft extends ie{constructor(){super(...arguments),this.points=[]}onStart(t){return this.el=document.createElementNS("http://www.w3.org/2000/svg","path"),this.points=[t],this.attr("fill",this.brush.color),this.attr("d",this.getSvgData(this.points)),this.el}onMove(t){return this.el||this.onStart(t),this.points[this.points.length-1]!==t&&this.points.push(t),this.attr("d",this.getSvgData(this.points)),!0}onEnd(){const t=this.el;return this.el=null,!!t}getSvgData(t){return ft.getSvgData(t,this.brush)}static getSvgData(t,n){const r=Ms(t,Re({size:n.size,thinning:.9,simulatePressure:!1,start:{taper:5},end:{taper:5}},n.stylusOptions));if(!r.length)return"";const s=r.reduce((i,[a,o],l,h)=>{const[c,p]=h[(l+1)%h.length];return i.push(a,o,(a+c)/2,(o+p)/2),i},["M",...r[0],"Q"]);return s.push("Z"),s.map(i=>typeof i=="number"?i.toFixed(2):i).join(" ")}};function Ls(e){return{draw:new ps(e),stylus:new Ts(e),line:new ys(e),rectangle:new _s(e),ellipse:new ms(e),eraseLine:new gs(e)}}var As=class{constructor(e={}){this.options=e,this.el=null,this.svgPoint=null,this.eventEl=null,this.shiftPressed=!1,this.altPressed=!1,this.drawing=!1,this._emitter=ls(),this._originalPointerId=null,this._models=Ls(this),this._opStack=[],this._opIndex=0,this._disposables=[],this._elements=[],this.options.brush||(this.options.brush={color:"black",size:3,mode:"stylus"}),e.el&&this.mount(e.el,e.eventTarget,e.window)}get model(){return this._models[this.mode]}get mounted(){return!!this.el}get mode(){return this.options.brush.mode||"stylus"}set mode(e){this._models[this.mode].onUnselected(),this.options.brush.mode=e,this.model.onSelected(this.el)}get brush(){return this.options.brush}set brush(e){this.options.brush=e}resolveSelector(e){return typeof e=="string"?document.querySelector(e):e||null}mount(e,t,n=window){if(this.el)throw new Error("[drauu] already mounted, unmount previous target first");if(this.el=this.resolveSelector(e),!this.el)throw new Error("[drauu] target element not found");if(this.el.tagName.toLocaleLowerCase()!=="svg")throw new Error("[drauu] can only mount to a SVG element");if(!this.el.createSVGPoint)throw new Error("[drauu] SVG element must be create by document.createElementNS('http://www.w3.org/2000/svg', 'svg')");this.svgPoint=this.el.createSVGPoint();const r=this.resolveSelector(t)||this.el,s=this.eventStart.bind(this),i=this.eventMove.bind(this),a=this.eventEnd.bind(this),o=this.eventKeyboard.bind(this);r.addEventListener("pointerdown",s,{passive:!1}),n.addEventListener("pointermove",i,{passive:!1}),n.addEventListener("pointerup",a,{passive:!1}),n.addEventListener("pointercancel",a,{passive:!1}),n.addEventListener("keydown",o,!1),n.addEventListener("keyup",o,!1),this._disposables.push(()=>{r.removeEventListener("pointerdown",s),n.removeEventListener("pointermove",i),n.removeEventListener("pointerup",a),n.removeEventListener("pointercancel",a),n.removeEventListener("keydown",o,!1),n.removeEventListener("keyup",o,!1)}),this._emitter.emit("mounted")}unmount(){this._disposables.forEach(e=>e()),this._disposables.length=0,this._elements.length=0,this.el=null,this._emitter.emit("unmounted")}on(e,t){return this._emitter.on(e,t)}undo(){return!this.canUndo()||this.drawing?!1:(this._opStack[--this._opIndex].undo(),this._emitter.emit("changed"),!0)}redo(){return!this.canRedo()||this.drawing?!1:(this._opStack[this._opIndex++].redo(),this._emitter.emit("changed"),!0)}canRedo(){return this._opIndex<this._opStack.length}canUndo(){return this._opIndex>0}eventMove(e){!this.acceptsInput(e)||!this.drawing||this.model._eventMove(e)&&(e.stopPropagation(),e.preventDefault(),this._emitter.emit("changed"))}eventStart(e){this.acceptsInput(e)&&(e.stopPropagation(),e.preventDefault(),this._currentNode&&this.cancel(),this.drawing=!0,this._originalPointerId=e.pointerId,this._emitter.emit("start"),this._currentNode=this.model._eventDown(e),this._currentNode&&this.mode!=="eraseLine"&&this.el.appendChild(this._currentNode),this._emitter.emit("changed"))}eventEnd(e){if(!this.acceptsInput(e)||!this.drawing)return;const t=this.model._eventUp(e);if(!t)this.cancel();else if(t===!0){const n=this._currentNode;n&&(this._appendNode(n),this.commit({undo:()=>this._removeNode(n),redo:()=>this._restoreNode(n)}))}else this.commit(t);this.drawing=!1,this._emitter.emit("end"),this._emitter.emit("changed"),this._originalPointerId=null}acceptsInput(e){return(!this.options.acceptsInputTypes||this.options.acceptsInputTypes.includes(e.pointerType))&&!(this._originalPointerId&&this._originalPointerId!==e.pointerId)}eventKeyboard(e){this.shiftPressed===e.shiftKey&&this.altPressed===e.altKey||(this.shiftPressed=e.shiftKey,this.altPressed=e.altKey,this.model.point&&this.model.onMove(this.model.point)&&this._emitter.emit("changed"))}commit(e){this._opStack.length=this._opIndex,this._opStack.push(e),this._opIndex++;const t=this._currentNode;this._currentNode=void 0,this._emitter.emit("committed",t)}clear(){this._opStack.length=0,this._opIndex=0,this._elements=[],this.cancel(),this.el.innerHTML="",this._emitter.emit("changed")}cancel(){this._currentNode&&(this.el.removeChild(this._currentNode),this._currentNode=void 0,this._emitter.emit("canceled"))}dump(){return this.el.innerHTML}load(e){this.clear(),this.el.innerHTML=e}_appendNode(e){const t=this._elements.at(-1);t?t.after(e):this.el.append(e);const n=this._elements.push(e)-1;e.dataset.drauu_index=n.toString()}_removeNode(e){e.remove(),this._elements[+e.dataset.drauu_index]=null}_restoreNode(e){const t=+e.dataset.drauu_index;this._elements[t]=e;for(let n=t-1;n>=0;n--){const r=this._elements[n];if(r){r.after(e);return}}this.el.prepend(e)}};function Rs(e){return new As(e)}const Ds=Et(()=>{const{currentSlideNo:e,isPresenter:t}=de(),n=["#ff595e","#ffca3a","#8ac926","#1982c4","#6a4c93","#ffffff","#000000"],r=$e("slidev-drawing-enabled",!1),s=$e("slidev-drawing-pinned",!1),i=Pt($e("slidev-drawing-brush",{color:n[0],size:4,mode:"stylus"})),a=P(!1),o=P(!1),l=P(!1),h=P(!1),c=P("stylus"),p=y(()=>Ae.drawings.syncAll||t.value);let E=!1;const f=y({get(){return c.value},set(u){c.value=u,u==="arrow"?(g.mode="line",i.arrowEnd=!0):(g.mode=u,i.arrowEnd=!1)}}),d=K({brush:i,acceptsInputTypes:y(()=>r.value&&(!Ae.drawings.presenterOnly||t.value)?void 0:["pen"]),coordinateTransform:!1}),g=Ct(Rs(d));function _(){g.clear(),p.value&&Ye(e.value,"")}function w(){var u;l.value=g.canRedo(),o.value=g.canUndo(),h.value=!!((u=g.el)!=null&&u.children.length)}function m(u){E=!0;const v=Me[u||e.value];v!=null?g.load(v):g.clear(),w(),E=!1}return g.on("changed",()=>{if(w(),!E){const u=g.dump(),v=e.value;(Me[v]||"")!==u&&p.value&&Ye(v,g.dump())}}),Bt(u=>{E=!0,u[e.value]!=null&&g.load(u[e.value]||""),E=!1,w()}),kt(()=>{G(e,()=>{g.mounted&&m()},{immediate:!0})}),g.on("start",()=>a.value=!0),g.on("end",()=>a.value=!1),window.addEventListener("keydown",u=>{if(!r.value||Yt.value)return;const v=!u.ctrlKey&&!u.altKey&&!u.shiftKey&&!u.metaKey;let S=!0;u.code==="KeyZ"&&(u.ctrlKey||u.metaKey)?u.shiftKey?g.redo():g.undo():u.code==="Escape"?r.value=!1:u.code==="KeyL"&&v?f.value="line":u.code==="KeyA"&&v?f.value="arrow":u.code==="KeyS"&&v?f.value="stylus":u.code==="KeyR"&&v?f.value="rectangle":u.code==="KeyE"&&v?f.value="ellipse":u.code==="KeyC"&&v?_():u.code.startsWith("Digit")&&v&&+u.code[5]<=n.length?i.color=n[+u.code[5]-1]:S=!1,S&&(u.preventDefault(),u.stopPropagation())},!1),{brush:i,brushColors:n,canClear:h,canRedo:l,canUndo:o,clear:_,drauu:g,drauuOptions:d,drawingEnabled:r,drawingMode:f,drawingPinned:s,drawingState:Me,isDrawing:a,loadCanvas:m}}),Is=["innerHTML"],Mn=O({__name:"DrawingPreview",props:{page:{}},setup(e){const{drawingState:t}=Ds();return(n,r)=>x(t)[n.page]?(k(),T("svg",{key:0,class:"w-full h-full absolute top-0 pointer-events-none",innerHTML:x(t)[n.page]},null,8,Is)):se("v-if",!0)}}),W=K({});let zs=[],Fs=[];re(W,"$syncUp",!0);re(W,"$syncDown",!0);re(W,"$paused",!1);re(W,"$onSet",e=>zs.push(e));re(W,"$onPatch",e=>Fs.push(e));jt();re(W,"$patch",async()=>!1);const Ns=Kt(W,W,!0);var tt;(tt=window.navigator.userAgent.match(/Chrome\/(\d+)/))==null||tt[1];var st;(st=window.navigator.userAgent.match(/Chrome\/(\d+)/))==null||st[1];class Us{constructor(){this._screenshotSession=null}getSnapshot(t,n){const r=t+(n?"-dark":"-light"),s=Ns.state[r];if(!s)return;const i=lt(t);if(i&&(s==null?void 0:s.revision)===(i==null?void 0:i.meta.slide.revision))return s.image}async saveSnapshot(t,n,r){return!1}async startCapturing(t){return!1}}const Os=new Us,Xs=["id"],Ys=["id"],Bs={class:"slidev-slide-container w-full h-full relative"},js=["src"],Ks=O({__name:"SlideContainer",props:{width:{type:Number},meta:{default:()=>({})},isMain:{type:Boolean,default:!1},no:{type:Number,required:!1},useSnapshot:{type:Boolean,default:!1},contentStyle:{type:Object,default:()=>({})}},setup(e){const t=e,{isPrintMode:n}=de(),r=P(null),s=$t(r),i=P(null),a=y(()=>t.width??s.width.value),o=y(()=>t.width?t.width/Be.value:s.height.value),l=y(()=>je.value&&!n.value?+je.value:Math.min(a.value/Ke.value,o.value/Ge.value)),h=y(()=>({...t.contentStyle,height:`${Ge.value}px`,width:`${Ke.value}px`,transform:`translate(-50%, -50%) scale(${l.value})`,"--slidev-slide-scale":l.value})),c=y(()=>t.width?{width:`${t.width}px`,height:`${t.width/Be.value}px`}:{});if(t.isMain){const E=document.documentElement.style;Mt(()=>E.setProperty("--slidev-slide-scale",l.value.toString())),nt(()=>E.removeProperty("--slidev-slide-scale"))}Q(Vt,l),Q(qt,i);const p=y(()=>{if(!(t.no==null||!t.useSnapshot))return Os.getSnapshot(t.no,Gt.value)});return(E,f)=>p.value?(k(),T(ne,{key:1},[se(" Image Snapshot "),M("div",Bs,[M("img",{src:p.value,class:"w-full h-full object-cover",style:j(c.value)},null,12,js),f[0]||(f[0]=M("div",{absolute:"","bottom-1":"","right-1":"","p0.5":"","text-cyan:75":"","bg-cyan:10":"",rounded:"",title:"Snapshot"},[M("div",{class:"i-carbon-camera"})],-1))])],2112)):(k(),T("div",{key:0,id:e.isMain?"slide-container":void 0,ref_key:"container",ref:r,class:"slidev-slide-container",style:j(c.value)},[M("div",{id:e.isMain?"slide-content":void 0,ref_key:"slideElement",ref:i,class:"slidev-slide-content",style:j(h.value)},[Le(E.$slots,"default",{},void 0,!0)],12,Ys),Le(E.$slots,"controls",{},void 0,!0)],12,Xs))}}),Tn=ct(Ks,[["__scopeId","data-v-0e223625"]]),vt=Symbol("diContainer");function Gs(e){let t=0,n,r;const s=()=>{t-=1,r&&t<=0&&(r.stop(),n=void 0,r=void 0)};return((...i)=>(t+=1,r||(r=rt(!0),n=r.run(()=>e(...i))),it(s),n))}function Vs(e){let t,n;return((...r)=>(n||(n=rt(!0),t=n.run(()=>e(...r))),t))}function qs(){const e={services:K(new Map)};return Lt(vt,e),{register:(t,n,r={shared:!0})=>{const s=r.shared?Gs(n):Vs(n);e.services.set(t,s)}}}function _e(){const e=Tt(vt);if(!e)throw new Error("Di container not found");const t={inject:n=>{const r=e.services.get(n);if(!r)throw new Error(`Service with key ${String(n)} not found`);return r(t)}};return t}function xe(e){return Symbol.for(e.name)}function Hs(e){return typeof e=="number"?new Promise(t=>setTimeout(t,e)):new Promise(t=>{const n=Symbol(),r=setInterval(()=>{const s=e(n);s!==n&&(clearInterval(r),t(s))},100)})}const pt=()=>{const e=P(),t=P(1),n=P(),r=P(0),s=P(0),i=P(0),a=P(0);G(()=>e.value,async l=>{l||(e.value=await Hs(h=>document.querySelector("#slide-content")??h))},{immediate:!0});function o(){const l=e.value.getBoundingClientRect();n.value=l,r.value=l.left,s.value=l.top,i.value=e.value.clientWidth/t.value,a.value=e.value.clientHeight/t.value,t.value=l.width/e.value.clientWidth}return G(()=>e.value,()=>{o()}),te(window,"resize",()=>{o()}),K({slideElement:e,rect:n,scale:t,left:r,top:s,width:i,height:a})},we=xe(pt),mt=e=>{const t=e.inject(we),n=P(0),r=P(0),s=P(!1),i=P(!1),a=y(()=>(n.value-t.left)/t.scale),o=y(()=>(r.value-t.top)/t.scale),l=y(()=>Math.round(a.value/(t.width/t.scale)*1e4)/100),h=y(()=>Math.round(o.value/(t.height/t.scale)*1e4)/100);te(()=>t.slideElement,"mouseleave",()=>{s.value=!1}),te(()=>t.slideElement,"mouseenter",()=>{s.value=!0}),te(()=>t.slideElement,"mousedown",()=>{i.value=!0}),te(()=>t.slideElement,"mouseup",()=>{i.value=!1}),te(window,"mousemove",p=>{n.value=p.clientX,r.value=p.clientY});function c({x:p,y:E}){return{x:(p-t.left)/t.scale,y:(E-t.top)/t.scale}}return K({globalX:y(()=>n.value),globalY:y(()=>r.value),inSlide:y(()=>s.value),isDown:y(()=>i.value),localX:a,localY:o,localXPercent:l,localYPercent:h,globalToLocal:c})},Se=xe(mt),gt=()=>{const e=K({});return K({data:e})},he=xe(gt);function yt(){const e=new AbortController,t=e.signal;return t.abort=()=>e.abort(),t}function ze(e){const t=yt();return e.addEventListener("abort",()=>{t.abort()}),t}function Zs(e){return e==null?void 0:e._object}function _t(){const e=P(new Set),t=P(null),n=P(null);let r=null;class s{constructor(o){this.signal=yt(),this.hoveredSignal=null,this.locked=!1,this.element=o,this.addListener("mouseenter",this.onEnter)}addListener(o,l,h=this.signal){this.element.addEventListener(o,l.bind(this),{signal:h})}onEnter(){this.hoveredSignal=ze(this.signal),this.addListener("click",this.onClick,this.hoveredSignal),this.addListener("mouseleave",this.onLeave,this.hoveredSignal),t.value=this.element}onClick(){this.locked||(n.value=n.value===this.element?null:this.element)}onLeave(){this.hoveredSignal.abort(),this.hoveredSignal=null,t.value=null}dispose(){console.log("dispose"),this.signal.abort()}}function i(){const a=document.querySelectorAll("#slide-content .\\$obj"),o=new Set(a);[...o].filter(c=>!e.value.has(c)).forEach(c=>{e.value.add(c),c._object=new s(c)}),[...e.value].filter(c=>!o.has(c)).forEach(c=>{var p;e.value.delete(c),(p=c._object)==null||p.dispose()})}return r=setInterval(i,1e3),it(()=>{r&&(clearInterval(r),r=null)}),K({objects:e,hovered:t,active:n})}const xt=xe(_t),Qs=O({__name:"CoordHelper",setup(e){V();const t=qs();return t.register(we,pt),t.register(Se,mt),t.register(xt,_t),t.register(he,gt,{shared:!1}),(n,r)=>(k(),ot(At,{to:"body"},[Le(n.$slots,"default")]))}}),Ws=["onClick"],Js=["onClick"],en=["onClick"],tn=["onClick"],sn=["onClick"],nn=["onClick"],rn=["onClick"],on=["onClick"],an=["onClick"],ln=["onClick"],cn=O({__name:"MemoryEditor",setup(e){V();const t=_e().inject(he);function n(o){navigator.clipboard.writeText(o)}const r=P(),{style:s}=Rt(r,{initialValue:{x:0,y:0}});function i(){t.data.savedPositions=[]}function a(o){t.data.savedPositions=t.data.savedPositions.filter(l=>l!==o)}return(o,l)=>{const h=ss;return k(),T("div",{ref_key:"draggableElement",ref:r,class:"fixed bg-black/40 p-2 rounded-xl h-auto w-auto z-100 max-w-[400px] flex flex-col gap-2 font-mono text-xs select-none",style:j(x(s))},[(k(!0),T(ne,null,Xe(x(t).data.savedPositions,c=>(k(),T("div",{key:c.x+":"+c.y,class:"flex flex-wrap bg-blue-500/20 rounded-full overflow-hidden"},[M("div",{class:"record",onClick:p=>n(`${c.x.toFixed(0)}`)}," x:"+R(c.x.toFixed(0)),9,Ws),M("div",{class:"record",onClick:p=>n(`${c.y.toFixed(0)}`)}," y:"+R(c.y.toFixed(0)),9,Js),M("div",{class:"record",onClick:p=>n(`${c.xPercent}%`)}," x%:"+R(c.xPercent),9,en),M("div",{class:"record",onClick:p=>n(`${c.yPercent}%`)}," y%:"+R(c.yPercent),9,tn),M("div",{class:"record",onClick:p=>a(c)},[Y(h)],8,sn)]))),128)),(k(!0),T(ne,null,Xe(x(t).data.savedChanges.values(),c=>(k(),T("div",{key:c.x+":"+c.y,class:"flex flex-wrap bg-blue-500/20 rounded-full overflow-hidden"},[M("div",{class:"record",onClick:p=>n(`${c.x.toFixed(0)}`)},"x:"+R(c.x.toFixed(0)),9,nn),M("div",{class:"record",onClick:p=>n(`${c.y.toFixed(0)}`)},"y:"+R(c.y.toFixed(0)),9,rn),M("div",{class:"record",onClick:p=>n(`size-${c.width.toFixed(0)}_${c.height.toFixed(0)}`)}," size ",8,on),M("div",{class:"record",onClick:p=>n(`pos-${c.x.toFixed(0)}_${c.y.toFixed(0)}`)}," pos ",8,an),M("div",{class:"record",onClick:p=>n(`sp-${c.x.toFixed(0)}_${c.y.toFixed(0)}_${c.width.toFixed(0)}_${c.height.toFixed(0)}`)}," sp ",8,ln)]))),128)),M("div",{class:"bg-blue-500/30 active:bg-blue-500 px-2 py-1 rounded-full cursor-pointer duration-100 self-center",onClick:l[0]||(l[0]=c=>i())},[Y(h)])],4)}}}),un=O({__name:"ObjectEdit",setup(e){V();const t=_e(),n=t.inject(xt),r=t.inject(Se),s=t.inject(we),i=t.inject(he);i.data.savedChanges=new Map;const a=new Set(["ArrowDown","ArrowUp","ArrowRight","ArrowLeft"]),o=y(()=>{var d;return f.value??((d=n.active)==null?void 0:d.getBoundingClientRect())}),l=y(()=>{var g;const d=(g=n.hovered)==null?void 0:g.getBoundingClientRect();return d?{left:`${d.left}px`,top:`${d.top}px`,width:`${d.width}px`,height:`${d.height}px`}:null}),h=y(()=>o.value?{left:`${o.value.left}px`,top:`${o.value.top}px`,width:`${o.value.width}px`,height:`${o.value.height}px`}:{});let c=null,p=null,E=null;const f=P();return G(()=>Zs(n.active),(d,g)=>{g&&(p==null||p.abort(),p=null),d&&(p=ze(d.signal),d._registered||(d._registered=!0,d.signal.addEventListener("abort",()=>{i.data.savedChanges.delete(d)})),document.body.addEventListener("keydown",_=>{if(console.log(_.key),_.key==="Escape"){n.active=null;return}if(!a.has(_.key))return;f.value=d.element.getBoundingClientRect();const w=r.globalToLocal({x:f.value.left,y:f.value.top});w.width=f.value.width/s.scale,w.height=f.value.height/s.scale;let m=_.shiftKey?10:_.altKey?1:5;_.key==="ArrowDown"?w.y+=m:_.key==="ArrowUp"?w.y-=m:_.key==="ArrowRight"?w.x+=m:_.key==="ArrowLeft"&&(w.x-=m);const u=w.x+w.width/2,v=w.y+w.height/2;d.element.style.transition="none",d.element.style.left=`${u}px`,d.element.style.top=`${v}px`,console.log({left:d.element.style.left,top:d.element.style.top}),f.value=d.element.getBoundingClientRect(),i.data.savedChanges.set(d,{x:u,y:v,width:w.width/s.scale,height:w.height/s.scale}),_.stopImmediatePropagation()},{signal:p,capture:!0}),document.body.addEventListener("keyup",_=>{a.has(_.key)&&d.element.style.removeProperty("transition")},{signal:p,capture:!0}),d.addListener("mousedown",_=>{_.stopImmediatePropagation(),c=ze(p);const w=d.element.getBoundingClientRect(),m=(_.clientX-w.left-w.width/2)/s.scale,u=(_.clientY-w.top-w.height/2)/s.scale;E={x:m,y:u},d.element.style.transition="none",c.addEventListener("abort",()=>{d.element.style.removeProperty("transition")}),window.addEventListener("mousemove",v=>{d.locked=!0;const S=r.globalToLocal({x:v.clientX,y:v.clientY});f.value=d.element.getBoundingClientRect();const L={x:S.x-E.x,y:S.y-E.y,width:f.value.width/s.scale,height:f.value.height/s.scale};d.element.style.left=`${L.x}px`,d.element.style.top=`${L.y}px`,i.data.savedChanges.set(d,L)},{signal:c}),window.addEventListener("mouseup",v=>{c==null||c.abort(),c=null,f.value=void 0,setTimeout(()=>{d.locked=!1},100)},{signal:c})},p))}),(d,g)=>(k(),T(ne,null,[l.value&&x(n).active!==x(n).hovered?(k(),T("div",{key:0,class:"fixed pointer-events-none border-2 z-[999] border-blue-500",style:j(l.value)},null,4)):se("v-if",!0),x(n).active?(k(),T("div",{key:1,class:"fixed pointer-events-none border-2 z-[999] border-green-500",style:j(h.value)},null,4)):se("v-if",!0)],64))}}),dn=O({__name:"MouseSizeSelect",setup(e){V();const t=_e(),n=t.inject(Se),r=t.inject(he),s=t.inject(we);return G(()=>n.isDown,i=>{i?r.data.selectSize={startX:n.globalX,startY:n.globalY}:r.data.selectSize=null}),G(()=>[n.globalX,n.globalY],([i,a])=>{r.data.selectSize&&(r.data.selectSize.width=Math.abs(i-r.data.selectSize.startX)/s.scale,r.data.selectSize.height=Math.abs(a-r.data.selectSize.startY)/s.scale,r.data.selectSize.widthPercent=Math.round(r.data.selectSize.width/(s.width??0)*1e4)/100,r.data.selectSize.heightPercent=Math.round(r.data.selectSize.height/(s.height??0)*1e4)/100)}),(i,a)=>x(r).data.selectSize?(k(),T("div",{key:0,ref:"selectionBox",class:"fixed b-[1px] border-dashed border-white/50 pointer-events-none",style:j({left:`${Math.min(x(r).data.selectSize.startX,x(n).globalX)}px`,top:`${Math.min(x(r).data.selectSize.startY,x(n).globalY)}px`,width:`${Math.abs(x(n).globalX-x(r).data.selectSize.startX)}px`,height:`${Math.abs(x(n).globalY-x(r).data.selectSize.startY)}px`})},null,4)):se("v-if",!0)}}),hn=O({__name:"MousePosTooltip",setup(e){var o;V();const t=_e(),n=t.inject(Se),r=t.inject(he);(o=r.data).savedPositions??(o.savedPositions=[]);const s=y(()=>r.data.selectSize?{width:Math.round(r.data.selectSize.width)||0,height:Math.round(r.data.selectSize.height)||0,widthPercent:Math.round(r.data.selectSize.widthPercent*100)/100||0,heightPercent:Math.round(r.data.selectSize.heightPercent*100)/100||0}:null),i=y(()=>s.value?s.value.width!==0||s.value.height!==0:!1),{alt_q:a}=Dt();return G(a,l=>{l&&r.data.savedPositions.push({x:n.globalX,y:n.globalY,xPercent:n.localXPercent,yPercent:n.localYPercent})}),(l,h)=>x(n).inSlide?(k(),T("div",{key:0,class:"absolute bg-[rgba(0,0,0,0.8)] text-white p-2 rounded-md text-sm pointer-events-none z-[1000] font-mono",style:j({left:`${x(n).globalX+10}px`,top:`${x(n).globalY+10}px`})},[i.value?(k(),T(ne,{key:0},[pe(" width: "+R(s.value.width)+"px ("+R(s.value.widthPercent)+"%) ",1),h[0]||(h[0]=M("br",null,null,-1)),pe(" height: "+R(s.value.height)+"px ("+R(s.value.heightPercent)+"%) ",1)],64)):(k(),T(ne,{key:1},[pe(" px "+R(Math.round(x(n).localX))+" "+R(Math.round(x(n).localY))+" ",1),h[1]||(h[1]=M("br",null,null,-1)),pe(" % "+R(x(n).localXPercent)+" "+R(x(n).localYPercent),1)],64))],4)):se("v-if",!0)}}),fn={class:"right-5 bottom-5 absolute text-lg opacity-50"},vn={__name:"global-top",setup(e){V();const{currentSlideNo:t,currentSlideRoute:n}=de(),r=y(()=>{var s,i;return((i=(s=n.value.meta)==null?void 0:s.slide)==null?void 0:i.frontmatter)||{}});return(s,i)=>{const a=hn,o=dn,l=un,h=cn,c=Qs;return k(),T("div",{class:me(["absolute top-0 left-0 w-full h-full pointer-events-none",r.value.slideClass])},[Y(c,null,{default:It(()=>[Y(a),Y(o),Y(l),Y(h)]),_:1}),M("div",fn,R(x(t)),1),M("div",{class:me(x(ns)(["absolute pos-20 text-[2.5em] transition-all duration-500",r.value.topTitleClass]))},R(r.value.topTitle),3)],2)}}},pn=O({__name:"GlslBackground",props:{fragmentShader:{},vertexShader:{default:`
        attribute vec4 aVertexPosition;
        varying vec2 v_texCoord;
        void main() {
            v_texCoord = (aVertexPosition.xy + 1.0) / 2.0;
            gl_Position = aVertexPosition;
        }
    `},uniforms:{default:()=>({})},textures:{default:()=>[]}},setup(e){V();const t=e,n=P(null),r=P(null);let s=null,i=null,a=null,o=Date.now(),l={},h={},c={};const p=async(m,u)=>{if(!s)return null;const v=s.createTexture();if(!v)return null;const S=m.name||`u_texture${u}`,L=u;c[S]=L,s.activeTexture(s.TEXTURE0+L),s.bindTexture(s.TEXTURE_2D,v),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,new Uint8Array([0,0,0,255]));const oe=async()=>typeof m.source=="string"?new Promise((z,F)=>{const D=new Image;D.onload=()=>z(D),D.onerror=F,D.src=m.source}):m.source;try{const z=await oe();s.activeTexture(s.TEXTURE0+L),s.bindTexture(s.TEXTURE_2D,v);const F=m.options||{},D=F.wrap==="repeat"?s.REPEAT:F.wrap==="mirror"?s.MIRRORED_REPEAT:s.CLAMP_TO_EDGE;s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,D),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,D);const X=F.filter==="nearest"?s.NEAREST:s.LINEAR;return s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,X),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,X),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,F.flipY?1:0),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,z),v}catch(z){return console.error("Error loading texture:",z),null}},E=async()=>{!s||!i||(Object.values(h).forEach(m=>{m&&s&&s.deleteTexture(m)}),h={},c={},await Promise.all(t.textures.map(async(m,u)=>{const v=await p(m,u);if(v){const S=m.name||`u_texture${u}`;h[S]=v;const L=s.getUniformLocation(i,S);L&&s.uniform1i(L,c[S])}})))},f=(m,u)=>{if(!s||!i)return;const v=l[m]??s.getUniformLocation(i,m);if(v)switch(l[m]=v,u.type){case"float":s.uniform1f(v,u.value);break;case"vec2":s.uniform2fv(v,u.value);break;case"vec3":s.uniform3fv(v,u.value);break;case"vec4":s.uniform4fv(v,u.value);break;case"int":s.uniform1i(v,u.value);break;case"bool":s.uniform1i(v,u.value?1:0);break}},d=()=>{if(!s||!i)return;const m=s.getUniformLocation(i,"u_time"),u=s.getUniformLocation(i,"u_resolution");m&&s.uniform1f(m,(Date.now()-o)/1e3),u&&r.value&&s.uniform2f(u,r.value.width,r.value.height),Object.entries(t.uniforms).forEach(([v,S])=>{f(v,S)}),Object.entries(h).forEach(([v,S])=>{if(S){const L=c[v];s.activeTexture(s.TEXTURE0+L),s.bindTexture(s.TEXTURE_2D,S)}})},g=()=>{if(!s||!r.value)return;const m=s.createShader(s.VERTEX_SHADER),u=s.createShader(s.FRAGMENT_SHADER);if(!m||!u)return;if(s.shaderSource(m,t.vertexShader),s.compileShader(m),!s.getShaderParameter(m,s.COMPILE_STATUS)){console.error("Vertex shader compilation failed:",s.getShaderInfoLog(m));return}if(s.shaderSource(u,t.fragmentShader),s.compileShader(u),!s.getShaderParameter(u,s.COMPILE_STATUS)){console.error("Fragment shader compilation failed:",s.getShaderInfoLog(u));return}if(i=s.createProgram(),!i)return;if(s.attachShader(i,m),s.attachShader(i,u),s.linkProgram(i),!s.getProgramParameter(i,s.LINK_STATUS)){console.error("Unable to initialize the shader program:",s.getProgramInfoLog(i));return}s.useProgram(i);const v=new Float32Array([-1,-1,1,-1,-1,1,1,1]),S=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,S),s.bufferData(s.ARRAY_BUFFER,v,s.STATIC_DRAW);const L=s.getAttribLocation(i,"aVertexPosition");s.enableVertexAttribArray(L),s.vertexAttribPointer(L,2,s.FLOAT,!1,0,0),l={},E()},_=()=>{!r.value||!s||!n.value||(r.value.width=n.value.clientWidth,r.value.height=n.value.clientHeight,s.viewport(0,0,r.value.width,r.value.height))},w=()=>{!s||!i||!r.value||(d(),s.drawArrays(s.TRIANGLE_STRIP,0,4),a=requestAnimationFrame(w))};return at(()=>{if(r.value){if(s=r.value.getContext("webgl2"),!s){console.error("Unable to initialize WebGL");return}_(),window.addEventListener("resize",_),g(),w()}}),zt(()=>{window.removeEventListener("resize",_),a!==null&&cancelAnimationFrame(a),s&&Object.values(h).forEach(m=>{m&&s.deleteTexture(m)})}),G([()=>t.fragmentShader,()=>t.vertexShader,()=>t.uniforms,()=>t.textures],()=>{!s||!i||(s.deleteProgram(i),g())}),(m,u)=>(k(),T("div",{ref_key:"container",ref:n,class:"absolute inset-0 z-[-10] w-full h-full"},[M("canvas",{ref_key:"canvas",ref:r,id:"glsl-background"},null,512)],512))}}),mn=`#ifdef GL_ES\r
precision highp float;\r
#endif\r
\r
uniform float u_time;\r
uniform vec2 u_resolution;\r
uniform vec4 u_baseColor;\r
#define PI 3.14159265359\r
\r
\r
void main() {\r
  float d;\r
  float z = 0.0;\r
  float T = u_time * 0.4;  // Slow down time by 2.5x for smoother animation\r
  \r
  vec3 O = vec3(0.0);\r
  vec3 p;\r
  vec3 S;\r
  \r
  vec2 C = gl_FragCoord.xy;\r
  vec2 r = u_resolution.xy;\r
  vec2 Q;\r
  vec4 o;\r
  \r
  // FIX: Declare loop counter directly in the for statement\r
  for (float i = 0.0; i < 60.0; i++) {\r
    // Ray setup: convert 2D screen coordinate C to 3D ray direction\r
    p = z * normalize(vec3(C - 0.5 * r, r.y));  // Create ray from camera through pixel\r
    p.z -= 4.0;  // Move camera back 4 units from origin\r
    S = p;  // Save original ray position for later color calculations\r
    \r
    // Distance field animation: create wobbly, time-varying surface\r
    d = p.y - T;  // Base distance varies with height and time (makes it flow)\r
    p.x += 0.4 * (1.0 + p.y) * sin(d) * cos(0.34 * d);  // Add wavy distortion that varies with height\r
    \r
    // 2D rotation matrix applied to xz plane - makes the shape twist as it flows\r
    Q = p.xz * mat2(cos(p.y + vec4(0, 11, 33, 0) - T));\r
    p.xz = Q;\r
    \r
    // Distance field calculation: how far are we from the surface?\r
    d = abs(sqrt(length(Q * Q)) - 0.25 * (5.0 + S.y)) / 3.0 + 8e-4;  // "Square" cylindrical surface with varying radius\r
    z += d;\r
    \r
    // Color calculation: generate RGBA color based on position and movement\r
    o = vec4(1.0) + sin(S.y + p.z * 0.5 + S.z - length(S - p) + vec4(2.0, 1.0, 0.0, 8.0));\r
    \r
    // Accumulate color: blend current color into total, weighted by alpha and distance\r
    O += o.w / d * o.xyz;\r
  }\r
  \r
  // Tone mapping: convert accumulated brightness to visible range [0,1]\r
  vec3 color = 1.0 - exp(-O * 0.000143);  // tanh() prevents over-bright colors, /1e4 scales down accumulated values\r
  \r
  gl_FragColor = vec4(color * 0.3, 1.0);\r
}`,gn=O({__name:"global-bottom",setup(e){V();const{currentSlideRoute:t,currentSlideNo:n}=de(),r=y(()=>{var o,l;return((l=(o=t.value.meta)==null?void 0:o.slide)==null?void 0:l.frontmatter)||{}}),s=P([0,0,0,1]),i=Ft(s,{duration:2e3,transition:Nt.linear});function a(o){return new Promise(l=>setTimeout(l,o))}return G(n,async()=>{const o=`[data-slidev-no="${n.value}"] .slidev-layout`;for(;!document.querySelector(o);)await a(10),console.log(o);const l=document.querySelector(o),h=getComputedStyle(l).getPropertyValue("--v-color");s.value=h.replace("rgb(","").replace(")","").split(",").map(c=>Number(c)/255).concat(1)},{immediate:!0}),(o,l)=>(k(),T("div",{class:me(r.value.slideClass)},[Y(pn,{fragmentShader:x(mn),uniforms:{u_baseColor:{type:"vec4",value:x(i)}}},null,8,["fragmentShader","uniforms"])],2))}}),yn=O({__name:"slide-bottom",setup(e){const t=Ut("root");function n(i,a){if(a===null||typeof a!="object")return a;(i===null||typeof i!="object")&&(i={});for(const o in a)Object.prototype.hasOwnProperty.call(a,o)&&(i[o]=n(i[o],a[o]));return i}let r=de(),s=V();if(s.$frontmatter.timeline){const i=y(()=>s.$frontmatter.timeline),a=y(()=>{let f=new Set(Object.keys(i.value[0]));return f.delete("$clicksAlias"),f.add("$stepsCount"),Array.from(f)});let o=y(()=>i.value.length);const l=y(()=>{const f=o.value,d=Array.from({length:f},()=>n({},i.value[0]));let g=0,_={};return i.value.forEach(w=>{let m=0,u=f;m=g++,w.$clicksAlias&&(Array.isArray(w.$clicksAlias)?w.$clicksAlias.forEach(v=>{_[v]=[m,u]}):_[w.$clicksAlias]=[m,u]);for(let v=m;v<u;v++)d[v]=n(d[v],w)}),{states:d,aliases:_}}),h=y(()=>l.value.aliases),c=y(()=>Math.min(r.clicks.value,o.value-1)),p=y(()=>l.value.states[c.value]),E=[a.value.map(f=>[f,y(()=>{var g;const d=(g=p.value)==null?void 0:g[f];return d===void 0&&console.warn(`Key ${f} not found in ${p.value} ${c.value}`),d})]),Object.keys(h.value).map(f=>[f,y(()=>h.value[f][c.value])]),[["$stepsCount",y(()=>l.value.states.length)]]].flat();s.$clicksContext.timeline=K(Object.fromEntries(E)),console.log("make timeline"),at(()=>{s.$clicksContext.register(t.value,s.$clicksContext.calculateSince(0,o.value))}),nt(()=>{s.$clicksContext.unregister(t.value)})}return(i,a)=>(k(),T("span",{ref_key:"root",ref:t},null,512))}}),Ln={render:()=>[Fe(vn)]},An={render:()=>[Fe(gn)]},_n={render:()=>[]},xn={render:()=>[Fe(yn)]},wn=["data-slidev-no","lang"],Sn=O({__name:"SlideWrapper",props:{clicksContext:{type:Object,required:!0},renderContext:{type:String,default:"slide"},route:{type:Object,required:!0}},setup(e){const t=e,n=y(()=>{var i,a;return((a=(i=t.route.meta)==null?void 0:i.slide)==null?void 0:a.frontmatter.zoom)??1});Q(Ht,t.route),Q(Zt,t.route.meta.slide.frontmatter),Q(Qt,P(t.route.no)),Q(Wt,P(t.renderContext)),Q(Jt,Ot(t,"clicksContext")),Q(es,n);const r=y(()=>n.value===1?void 0:{width:`${100/n.value}%`,height:`${100/n.value}%`,transformOrigin:"top left",transform:`scale(${n.value})`}),s=y(()=>({...r.value,"user-select":Ae.selectable?void 0:"none"}));return(i,a)=>(k(),T("div",{"data-slidev-no":t.route.no,class:me(x(ts)(e.route,["slide","presenter"].includes(t.renderContext)?"":"disable-view-transition")),style:j(s.value),lang:t.route.meta.slide.frontmatter.lang},[Y(x(xn)),(k(),ot(Xt(t.route.component))),Y(x(_n))],14,wn))}}),Rn=ct(Sn,[["__scopeId","data-v-6c84c8ab"]]);export{An as G,Rn as S,Mn as _,$n as a,Tn as b,rs as c,Ln as d,Ds as u};
